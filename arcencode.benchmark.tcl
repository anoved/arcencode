source arcencode.tcl

# random_walk generated in encoded_polyline with `ruby script/benchmark.rb 533273`
set random_walk {48.0051976276976 31.9980140937744 48.0107318011042 32.0026145936687 48.0062455318997 31.9971798988386 48.0135658044414 31.9930575226097 48.0058532989942 31.9895542756408 48.0077465176054 31.9817717749868 48.01479849938 31.98369480013 48.0159796570327 31.9924749824904 48.0070278382282 32.0016419319639 48.0069662759424 32.0082253473479 48.0127452514551 31.9990229558113 48.0098498544431 32.0020045018361 48.0107655972233 32.0037506509046 48.0104330068873 32.0025350658462 48.0143776054042 32.0103755634859 48.0090729913121 32.0057412332671 48.0179710790604 32.0035977164793 48.0176101108907 32.0125675127851 48.0195028641911 32.0141617212751 48.0216353661977 32.0103091802639 48.0135286949699 32.0147346738261 48.0037810464199 32.0129908072863 48.0094470100318 32.0200681851742 48.0153574132197 32.0143662842737 48.0168564972621 32.0071022117575 48.0105661531608 32.0010857080764 48.0090176987692 32.0006258457796 48.0130256024626 31.9930095521273 48.0094512430241 31.9958544472887 48.0070395777887 31.9946240780079 48.0036902364784 31.9960372277773 47.9977870262106 31.9989061991325 48.0030845623752 31.9893889745896 48.001879068447 31.9833545157061 48.009568234587 31.9903536623312 48.006404806486 31.9815741905758 47.9978880345892 31.9860723924646 47.9922081471714 31.9939414155259 48.0021962025369 31.9935456470385 48.0083766095293 31.9843027946893 48.01033340717 31.9930236390975 48.013006165525 31.9965977755454 48.0096911933342 31.992674235891 48.0087459558701 31.9863978391172 48.0166846650717 31.9898459957732 48.0120907384437 31.9820498887718 48.0042814266749 31.9832500615919 47.9948583083669 31.9771785353687 47.9979739602554 31.9776481027958 48.0068806013502 31.981951360906 48.0066968301191 31.9757771222107 48.0082244540262 31.9786408405855 48.0119001182655 31.9716185222907 48.0098255266507 31.9674283360455 48.0159372312742 31.9725892681676 48.0183625693751 31.9774562997666 48.0234823870106 31.9804945550814 48.0291345955531 31.9706026243295 48.0212317025651 31.9729137120957 48.0157848257748 31.9793472498266 48.024880950443 31.9872860573328 48.0210676322117 31.9932507755849 48.0202312170638 31.9838772733363 48.0276606547231 31.9838973760174 48.0301111297715 31.9765136147985 48.0392407496977 31.9791135531933 48.0397354774584 31.9772703721671 48.0300579194691 31.9869298356893 48.0328993253708 31.9878769332839 48.0426818972176 31.9968206783286 48.04998027455 32.0042410775415 48.0596464285513 32.0066766769981 48.0622390950039 32.01146640201 48.0577675780792 32.0026940414226 48.054353408778 31.9946724003758 48.0504467202295 31.9925410510656 48.0462319689413 31.984572755505 48.0369286753028 31.9751289389399 48.0335058463897 31.975306563505 48.0383226532962 31.9754391027183 48.0455611828205 31.9737985324291 48.0453357790386 31.9735574184758 48.0428864910916 31.9660068587254 48.0338280319835 31.9644769084131 48.0276001997327 31.9637621281053 48.0245556552525 31.9736411027824 48.0331772683737 31.9770983845212 48.0418929210153 31.9711795594299 48.0476404779259 31.9628861359638 48.0490165113298 31.9670579571036 48.0498888141359 31.9628591348235 48.0575331812174 31.9549236182144 48.0489385462344 31.9568509741603 48.045170578666 31.9589446246783 48.0503215315284 31.9559425481811 48.0452983906937 31.9628950103087 48.0499957136797 31.9661203777298 48.0508177301685 31.9651506773998 48.0482940086741 31.9554938791193 48.0521875515224 31.9606514820744}

set random_walk_text [arcencode::arcencode $random_walk]

#
# Parameters:
#	script, the code to benchmark. Executed in caller's context.
#	iterations, number of times to execute script. Defaults to 1.
#
# Returns:
#	a two-element list reporting the average iteration time to execute script
#	and the total elapsed time in microseconds.
#
proc benchmark {script {iterations 1}} {
	set start   [clock microseconds]
	set average [uplevel 1 [list time $script $iterations]]
	set end     [clock microseconds]
	set total   [expr {$end - $start}]
	return      [list [lindex $average 0] $total]
} 

puts [benchmark {arcencode::arcencode $random_walk} 10000]
puts [benchmark {arcencode::arcdecode $random_walk_text} 10000]

# Output (microseconds):
# 994.6163487 9946070
# 1615.5247761 16155092

# This compares favorably w/encoded_polyline's `ruby script/benchmark.rb 533273`
# (which processes the same data) on the same computer (9.9/16.2 vs 11.0/20.6).
#                           user     system      total        real
# encoding             10.870000   0.030000  10.900000 ( 11.032394)
# decoding             20.330000   0.040000  20.370000 ( 20.605234)
